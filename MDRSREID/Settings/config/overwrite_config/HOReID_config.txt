cfg.model.name = 'HOReID'
cfg.stage = 'FeatureExtract'  # 'FeatureExtract' or 'Evaluation'
cfg.model.use_ps = False
cfg.log.only_base_lr = True
cfg.id_loss.weight = 0
cfg.id_smooth_loss.weight = 1
cfg.id_smooth_loss.reduce = False
cfg.tri_hard_loss.weight = 1
cfg.permutation_loss.weight = 1.0
cfg.verification_loss.weight = 0.1
cfg.inv_loss.weight = 0
cfg.analyze_computer.use = True
cfg.verification_probability_analyze.use = True
cfg.dataset.test.names = ['duke']
cfg.dataset.use_occlude_duke = True
cfg.dataset.use_pose_landmark_mask = False
cfg.dataset.use_ps_label = False
cfg.dataset.train.type = 'Supervised'  # 'Supervised'
cfg.dataset.train.source.name = 'duke'  # ['market1501', 'cuhk03_np_detected_jpg', 'duke']
cfg.dataset.train.target.name = 'duke'
cfg.dataset.im.h_w = (256, 128)
cfg.dataloader.num_workers = 8
cfg.dataloader.train.batch_type = 'pk2'
cfg.dataloader.train.batch_size = 16 # 24,32
cfg.dataloader.train.batch_id = 4  # 6,8
cfg.dataloader.train.batch_image = 4
cfg.dataloader.test.batch_size = 128
cfg.dataset.train.before_to_tensor_transform_list = ['resize', 'hflip', 'pad', 'random_crop'] # 'random_sized_rect_crop'
cfg.dataset.train.after_to_tensor_transform_list = ['random_erasing']
cfg.eval.re_rank = False
cfg.optim.seperate_params = True
cfg.optim.optimizer = 'adam'
cfg.optim.phase = 'warmup_multi_step'
cfg.optim.use_gm_after_epoch = 20
cfg.optim.resume_epoch = 119
cfg.optim.base_lr = 0.00035
cfg.optim.gcn_lr_scale = 0.1
cfg.optim.gm_lr_scale = 1.0
cfg.optim.ver_lr_scale = 1.0
cfg.optim.epochs_per_val = 1
cfg.optim.resume = True
cfg.only_test = False