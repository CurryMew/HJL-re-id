cfg.model.backbone.last_conv_stride = 2
cfg.model.pool_type = 'MDRSPool'
cfg.model.name = 'MDRS'
cfg.model.em_dim = 256
cfg.model.use_ps = True
cfg.dataset.im.h_w = (384, 128)
cfg.dataset.test.names = ['market1501']
cfg.dataset.use_pose_landmark_mask = False
cfg.dataset.use_ps_label = True
cfg.dataset.train.type = 'Supervised'  # 'Supervised'
cfg.dataset.train.source.name = 'market1501'  # ['market1501', 'cuhk03_np_detected_jpg', 'duke']
cfg.dataset.train.target.name = 'market1501'
cfg.dataloader.train.batch_type = 'pk2'
cfg.dataloader.train.batch_size = 24 # 24,32
cfg.dataloader.train.batch_id = 6  # 6,8
cfg.dataloader.train.batch_image = 4
cfg.dataset.train.before_to_tensor_transform_list = ['hflip', 'resize'] # 'random_sized_rect_crop'
cfg.dataset.train.after_to_tensor_transform_list = ['random_erasing']
cfg.eval.re_rank = False
cfg.tri_loss.weight = 2
cfg.tri_loss.margin = 0.3
cfg.src_multi_seg_loss.weight = 1
cfg.src_multi_seg_gp_loss.weight = 0
cfg.inv_loss.weight = 0  # Unsupervised use
cfg.optim.optimizer = 'adam'
cfg.optim.ft_lr = 2e-4  #
cfg.optim.new_params_lr = 2e-4  #
cfg.optim.epochs_per_val = 20
cfg.optim.lr_decay_epochs = (320, 360, 400)  #
cfg.optim.normal_epochs = 400  # Not including warmup/pretrain
cfg.optim.resume = False
cfg.only_test = True  #

cfg.blocksetting.backbone = 3
cfg.blocksetting.pool = 3
cfg.blocksetting.reduction = 8
cfg.blocksetting.classifier = 8
cfg.blocksetting.ps = 3

cfg.dataset.im.random_erasing.proportion = False

cfg.vis.use = False
cfg.vis.heat_map.use = False