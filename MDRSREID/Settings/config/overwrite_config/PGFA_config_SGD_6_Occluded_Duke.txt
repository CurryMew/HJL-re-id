cfg.model.backbone.last_conv_stride = 1
cfg.model.pool_type = 'PGFAPool'
cfg.model.name = 'PGFA'
cfg.model.num_parts = 6
cfg.model.em_dim = 256
cfg.model.PGFA.global_input_dim = 4096
cfg.model.PGFA.part_feat_input_dim = 2048
cfg.model.reduction.use_relu = False
cfg.model.reduction.use_dropout = True
cfg.model.use_ps = False
cfg.dataset.im.h_w = (384, 128)
cfg.dataset.test.names = ['duke']
cfg.dataset.use_occlude_duke = True
cfg.dataset.use_pose_landmark_mask = True
cfg.dataset.use_ps_label = False
cfg.dataset.train.type = 'Supervised'  # 'Supervised'
cfg.dataset.train.source.name = 'duke'  # ['market1501', 'cuhk03_np_detected_jpg', 'duke']
cfg.dataset.train.target.name = 'duke'
cfg.dataloader.train.batch_type = 'random'
cfg.dataloader.train.batch_size = 24 # 24,32
cfg.dataloader.train.batch_id = 8  # 6,8
cfg.dataloader.train.batch_image = 4
cfg.dataset.train.before_to_tensor_transform_list = ['resize', 'hflip'] # 'random_sized_rect_crop'
cfg.dataset.train.after_to_tensor_transform_list = ['random_erasing']
cfg.eval.re_rank = False
cfg.id_loss.weight = 0
cfg.pgfa_loss.weight = 1
cfg.inv_loss.weight = 0  # Unsupervised use
cfg.optim.optimizer = 'sgd'
cfg.optim.phase = 'easy'
cfg.optim.every_lr_epoch = 40
cfg.optim.ft_lr = 0.001  #
cfg.optim.new_params_lr = 0.001  #
cfg.optim.epochs_per_val = 10
cfg.optim.lr_decay_epochs = (360, 420, 440)  #
cfg.optim.normal_epochs = 440  # Not including warmup/pretrain
cfg.optim.resume = True
cfg.only_test = False  #
